{% extends 'layout.html' %}

{% block content %}
<style>
    :root {
        --spark-yellow: #FFD93D;
        --spark-soft-yellow: #FFF9E5;
        --circle-blue: #6C9BCF;
        --circle-soft-blue: #EBF3FF;
    }

    .mypage-card {
        border-radius: 30px;
        border: none;
        overflow: hidden;
    }

    .mypage-header {
        background: linear-gradient(135deg, var(--spark-yellow) 0%, #f1ca2e 100%);
        padding: 40px 20px;
        text-align: center;
        color: #554400;
    }

    .profile-img-box {
        width: 120px;
        height: 120px;
        background: white;
        border-radius: 40px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 15px;
        box-shadow: 0 10px 20px rgba(0,0,0,0.05);
    }

    .info-label {
        color: var(--circle-blue);
        font-weight: 600;
        font-size: 0.9rem;
        display: block;
        margin-bottom: 2px;
    }

    .info-value {
        font-size: 1.1rem;
        color: #333;
        margin-bottom: 15px;
    }

    .activity-card {
        background-color: var(--spark-soft-yellow);
        border: none;
        border-radius: 20px;
        transition: transform 0.2s;
    }

    .activity-card:hover {
        transform: translateY(-5px);
    }

    .btn-edit {
        background-color: var(--spark-yellow);
        border: none;
        border-radius: 50px;
        color: #554400;
        font-weight: bold;
        padding: 10px 25px;
    }

    .btn-home {
        border: 2px solid var(--circle-blue);
        color: var(--circle-blue);
        border-radius: 50px;
        padding: 10px 25px;
        font-weight: bold;
    }

    .profile-img {
    width: 100%;
    height: 100%;
    object-fit: cover; /* 이미지가 비율에 맞게 꽉 차도록 설정 */
    border-radius: 40px; /* 기존 박스와 동일한 곡률 */
    }

    /* 박스 안에 이미지가 없을 때를 대비해 박스 속성 유지 */
    .profile-img-box {
        overflow: hidden; /* 이미지가 넘치면 자름 */
        border: 3px solid white; /* 로고 느낌을 주기 위한 테두리 */
    }
</style>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-9 col-lg-7">
            <div class="card mypage-card shadow-lg">

                <div class="mypage-header">
                    <div class="profile-img-box">
                        <img src="/static/profile_basic.png" style="width: 100%; height: 100%; object-fit: cover; border-radius: 40px;">
                    </div>
                    <h2 class="fw-bold mb-1">{{ user.nickname }} <small class="fs-6 opacity-75">({{ user.name }})</small></h2>
                    <span class="badge rounded-pill bg-white text-dark px-3 shadow-sm">{{ user.role.upper() }} 권한</span>
                </div>

                <div class="card-body p-4 p-md-5">
                    <div class="row">
                        <div class="col-md-6">
                            <h5 class="fw-bold mb-4" style="color: var(--circle-blue);"><i class="bi bi-info-circle-fill me-2"></i>기본 정보</h5>

                            <span class="info-label">아이디</span>
                            <p class="info-value">{{ user.uid }}</p>

                            <span class="info-label">실명 (본인확인용)</span>
                            <p class="info-value">
                                {{ user.name }}
                                <i class="bi bi-shield-lock-fill text-success ms-1" style="font-size: 0.8rem;" title="본인에게만 공개되는 정보입니다"></i>
                            </p>

                            <span class="info-label">생년월일</span>
                            <p class="info-value">
                                {{ user.birth_date.strftime('%Y년 %m월 %d일') if user.birth_date.strftime else user.birth_date }}
                            </p>

                            <span class="info-label">이메일</span>
                            <p class="info-value text-truncate">{{ user.email if user.email else "등록된 이메일 없음" }}</p>

                            <span class="info-label">전화번호</span>
                            <p class="info-value text-truncate">{{ user.phone_number if user.phone_number else "등록된 전화번호 없음" }}</p>

                            <span class="info-label">가입일</span>
                            <p class="info-value">{{ user.created_at.strftime('%Y-%m-%d') if user.created_at else "날짜없음" }}</p>
                        </div>

                        <div class="col-md-6">
                            <h5 class="fw-bold mb-4" style="color: var(--circle-blue);"><i class="bi bi-lightning-charge-fill me-2"></i>활동 요약</h5>

                            <div class="row g-3">
                                <div class="col-12">
                                    <div class="card activity-card">
                                        <div class="card-body d-flex justify-content-between align-items-center">
                                            <span class="fw-bold">내가 뿜어낸 Spark(게시글)</span>
                                            <a href="/board/my" class="h4 fw-bold text-dark text-decoration-none mb-0">{{ board_count }}건</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="card activity-card" style="background-color: var(--circle-soft-blue);">
                                        <div class="card-body d-flex justify-content-between align-items-center">
                                            <span class="fw-bold">나의 평가 기록</span>
                                            <a href="/score/my" class="h4 fw-bold text-primary text-decoration-none mb-0"><i class="bi bi-arrow-right-short"></i></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-footer bg-white border-0 text-end p-4">
                <a href="/member/edit" class="btn btn-warning btn-sm text-white">정보 수정</a>
                <button class="btn btn-outline-secondary btn-sm" onclick="location.href='/'">홈으로</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}